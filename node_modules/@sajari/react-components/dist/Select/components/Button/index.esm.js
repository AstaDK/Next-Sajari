import _css from '@emotion/css';
import { extends as _extends } from '../../../_virtual/_rollupPluginBabelHelpers.js';
import { getStylesObject } from '@sajari/react-sdk-utils';
import { useRef, useEffect, useMemo } from 'react';
import { jsx } from '@emotion/core/jsx-runtime';
import Box from '../../../Box/index.esm.js';
import { mergeProps } from '@react-aria/utils';
import { useSelectContext } from '../../context.esm.js';
import { useButtonStyles } from './styles.esm.js';

var Button = function Button() {
  var _useSelectContext = useSelectContext(),
      disabled = _useSelectContext.disabled,
      getToggleButtonProps = _useSelectContext.getToggleButtonProps,
      id = _useSelectContext.id,
      invalid = _useSelectContext.invalid,
      items = _useSelectContext.items,
      selectedItems = _useSelectContext.selectedItems,
      autofocus = _useSelectContext.autofocus,
      size = _useSelectContext.size,
      text = _useSelectContext.text,
      disableDefaultStyles = _useSelectContext.disableDefaultStyles,
      customClassNames = _useSelectContext.customClassNames;

  var _useButtonStyles = useButtonStyles({
    size: size,
    disabled: disabled,
    invalid: invalid
  }),
      buttonStyles = _useButtonStyles.styles,
      focusRingProps = _useButtonStyles.focusRingProps,
      focusRingStyles = _useButtonStyles.focusRingStyles;

  var styles = getStylesObject(buttonStyles, disableDefaultStyles);
  var ref = useRef(null);
  useEffect(function () {
    if (autofocus && (ref == null ? void 0 : ref.current)) {
      ref.current.focus();
    }
  }, []);
  var children = useMemo(function () {
    if (typeof text === 'function') {
      var selected = items.filter(function (_ref) {
        var v = _ref.value;
        return selectedItems.includes(v.toString());
      }).map(function (_ref2) {
        var label = _ref2.children;
        return label;
      });
      return text(selected);
    }

    if (typeof text !== 'undefined') {
      return text;
    }

    if (selectedItems.length === 1) {
      var selectedItem = selectedItems[0];

      var _selected = items.find(function (_ref3) {
        var v = _ref3.value;
        return selectedItem === v.toString();
      });

      if (_selected) {
        return _selected.children;
      }
    }

    if (selectedItems.length > 1) {
      return selectedItems.length + " selected";
    }

    return 'Select an option';
  }, [JSON.stringify(selectedItems), text]);
  return jsx(Box, _extends({
    as: "button",
    type: "button",
    css: /*#__PURE__*/_css([styles.container, focusRingStyles], ";label:Button;" + (process.env.NODE_ENV === "production" ? "" : "/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFzQzJDIiwiZmlsZSI6ImluZGV4LnRzeCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG1lcmdlUHJvcHMgfSBmcm9tICdAcmVhY3QtYXJpYS91dGlscyc7XHJcbmltcG9ydCB7IGdldFN0eWxlc09iamVjdCB9IGZyb20gJ0BzYWphcmkvcmVhY3Qtc2RrLXV0aWxzJztcclxuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgQm94IGZyb20gJy4uLy4uLy4uL0JveCc7XHJcbmltcG9ydCB7IHVzZVNlbGVjdENvbnRleHQgfSBmcm9tICcuLi8uLi9jb250ZXh0JztcclxuaW1wb3J0IHsgdXNlQnV0dG9uU3R5bGVzIH0gZnJvbSAnLi9zdHlsZXMnO1xyXG5jb25zdCBCdXR0b24gPSAoKSA9PiB7XHJcbiAgICBjb25zdCB7IGRpc2FibGVkLCBnZXRUb2dnbGVCdXR0b25Qcm9wcywgaWQsIGludmFsaWQsIGl0ZW1zLCBzZWxlY3RlZEl0ZW1zLCBhdXRvZm9jdXMsIHNpemUsIHRleHQsIGRpc2FibGVEZWZhdWx0U3R5bGVzLCBjdXN0b21DbGFzc05hbWVzLCB9ID0gdXNlU2VsZWN0Q29udGV4dCgpO1xyXG4gICAgY29uc3QgeyBzdHlsZXM6IGJ1dHRvblN0eWxlcywgZm9jdXNSaW5nUHJvcHMsIGZvY3VzUmluZ1N0eWxlcyB9ID0gdXNlQnV0dG9uU3R5bGVzKHsgc2l6ZSwgZGlzYWJsZWQsIGludmFsaWQgfSk7XHJcbiAgICBjb25zdCBzdHlsZXMgPSBnZXRTdHlsZXNPYmplY3QoYnV0dG9uU3R5bGVzLCBkaXNhYmxlRGVmYXVsdFN0eWxlcyk7XHJcbiAgICBjb25zdCByZWYgPSBSZWFjdC51c2VSZWYobnVsbCk7XHJcbiAgICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgICAgIGlmIChhdXRvZm9jdXMgJiYgcmVmPy5jdXJyZW50KSB7XHJcbiAgICAgICAgICAgIHJlZi5jdXJyZW50LmZvY3VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSwgW10pO1xyXG4gICAgY29uc3QgY2hpbGRyZW4gPSBSZWFjdC51c2VNZW1vKCgpID0+IHtcclxuICAgICAgICBpZiAodHlwZW9mIHRleHQgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBpdGVtc1xyXG4gICAgICAgICAgICAgICAgLmZpbHRlcigoeyB2YWx1ZTogdiB9KSA9PiBzZWxlY3RlZEl0ZW1zLmluY2x1ZGVzKHYudG9TdHJpbmcoKSkpXHJcbiAgICAgICAgICAgICAgICAubWFwKCh7IGNoaWxkcmVuOiBsYWJlbCB9KSA9PiBsYWJlbCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0ZXh0KHNlbGVjdGVkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGVvZiB0ZXh0ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGV4dDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNlbGVjdGVkSXRlbXMubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IFtzZWxlY3RlZEl0ZW1dID0gc2VsZWN0ZWRJdGVtcztcclxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBpdGVtcy5maW5kKCh7IHZhbHVlOiB2IH0pID0+IHNlbGVjdGVkSXRlbSA9PT0gdi50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgaWYgKHNlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWQuY2hpbGRyZW47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNlbGVjdGVkSXRlbXMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gYCR7c2VsZWN0ZWRJdGVtcy5sZW5ndGh9IHNlbGVjdGVkYDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICdTZWxlY3QgYW4gb3B0aW9uJztcclxuICAgIH0sIFtKU09OLnN0cmluZ2lmeShzZWxlY3RlZEl0ZW1zKSwgdGV4dF0pO1xyXG4gICAgcmV0dXJuICg8Qm94IGFzPVwiYnV0dG9uXCIgdHlwZT1cImJ1dHRvblwiIGNzcz17W3N0eWxlcy5jb250YWluZXIsIGZvY3VzUmluZ1N0eWxlc119IGNsYXNzTmFtZT17Y3VzdG9tQ2xhc3NOYW1lcy5idXR0b25DbGFzc05hbWV9IHsuLi5tZXJnZVByb3BzKGZvY3VzUmluZ1Byb3BzLCBnZXRUb2dnbGVCdXR0b25Qcm9wcyh7IGRpc2FibGVkLCByZWYgfSksIHsgaWQgfSl9PlxuICAgICAge2NoaWxkcmVufVxuICAgIDwvQm94Pik7XHJcbn07XHJcbmV4cG9ydCBkZWZhdWx0IEJ1dHRvbjtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanN4Lm1hcCJdfQ== */")),
    className: customClassNames.buttonClassName
  }, mergeProps(focusRingProps, getToggleButtonProps({
    disabled: disabled,
    ref: ref
  }), {
    id: id
  }), {
    children: children
  }));
};

export default Button;
//# sourceMappingURL=index.esm.js.map
