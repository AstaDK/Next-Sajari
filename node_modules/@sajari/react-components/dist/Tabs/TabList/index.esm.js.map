{"version":3,"file":"index.esm.js","sources":["../../../src/Tabs/TabList/index.tsx"],"sourcesContent":["import { __DEV__, cleanChildren, getStylesObject } from '@sajari/react-sdk-utils';\nimport React, { cloneElement, useRef } from 'react';\n\nimport Box from '../../Box';\nimport { useTabContext } from '../context';\nimport useTabListStyles from './styles';\nimport { TabListProps } from './types';\n\nconst TabList = React.forwardRef((props: TabListProps, ref?: React.Ref<HTMLDivElement>) => {\n  const { children, onKeyDown, onClick, styles: stylesProp, ...rest } = props;\n  const {\n    id,\n    index: selectedIndex,\n    manualIndex,\n    onManualTabChange,\n    manual,\n    onChangeTab,\n    onFocusPanel,\n    disableDefaultStyles = false,\n  } = useTabContext();\n  const styles = getStylesObject(useTabListStyles(), disableDefaultStyles);\n  const allNodes = useRef<(HTMLElement | null)[]>([]);\n  const validChildren = cleanChildren(children);\n\n  const focusableIndexes = validChildren\n    .map((child, index) => (child.props.disabled === true ? null : index))\n    .filter((index) => index != null) as number[];\n\n  const enabledSelectedIndex = focusableIndexes.indexOf(selectedIndex);\n  const count = focusableIndexes.length;\n\n  const updateIndex = (index: number) => {\n    const childIndex = focusableIndexes[index];\n\n    allNodes.current[childIndex]?.focus();\n\n    if (onChangeTab) {\n      onChangeTab(childIndex);\n    }\n  };\n\n  const handleKeyDown = (event: React.KeyboardEvent) => {\n    if (event.key === 'ArrowRight') {\n      event.preventDefault();\n      const nextIndex = (enabledSelectedIndex + 1) % count;\n      updateIndex(nextIndex);\n    }\n\n    if (event.key === 'ArrowLeft' || event.key === 'ArrowUp') {\n      event.preventDefault();\n      const nextIndex = (enabledSelectedIndex - 1 + count) % count;\n      updateIndex(nextIndex);\n    }\n\n    if (event.key === 'Home') {\n      event.preventDefault();\n      updateIndex(0);\n    }\n\n    if (event.key === 'End') {\n      event.preventDefault();\n      updateIndex(count - 1);\n    }\n\n    if (event.key === 'ArrowDown') {\n      event.preventDefault();\n\n      if (onFocusPanel) {\n        onFocusPanel();\n      }\n    }\n\n    if (onKeyDown) {\n      onKeyDown(event);\n    }\n  };\n\n  const clones = validChildren.map((child, index) => {\n    const selected = manual ? index === manualIndex : index === selectedIndex;\n\n    const handleClick = (event: React.MouseEvent) => {\n      // Hack for Safari. Buttons don't receive focus on click on Safari\n      // https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button#Clicking_and_focus\n      allNodes.current[index]?.focus();\n\n      onManualTabChange(index);\n      onChangeTab(index);\n\n      if (child.props.onClick) {\n        child.props.onClick(event);\n      }\n    };\n\n    return cloneElement(child, {\n      ref: (node: HTMLElement | null) => {\n        allNodes.current[index] = node;\n        return node;\n      },\n      selected,\n      onClick: handleClick,\n      id: `${id}-${index}`,\n    });\n  });\n\n  return (\n    <Box css={styles.container}>\n      <Box ref={ref} role=\"tablist\" onKeyDown={handleKeyDown} css={styles.innerContainer} {...rest}>\n        {clones}\n      </Box>\n    </Box>\n  );\n});\n\nif (__DEV__) {\n  TabList.displayName = 'TabList';\n}\n\nexport default TabList;\nexport type { TabListProps };\n"],"names":["TabList","React","forwardRef","props","ref","children","onKeyDown","rest","useTabContext","id","selectedIndex","index","manualIndex","onManualTabChange","manual","onChangeTab","onFocusPanel","disableDefaultStyles","styles","getStylesObject","useTabListStyles","allNodes","useRef","validChildren","cleanChildren","focusableIndexes","map","child","disabled","filter","enabledSelectedIndex","indexOf","count","length","updateIndex","childIndex","current","focus","handleKeyDown","event","key","preventDefault","nextIndex","clones","selected","handleClick","onClick","cloneElement","node","_jsx","container","innerContainer","__DEV__","displayName"],"mappings":"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"}