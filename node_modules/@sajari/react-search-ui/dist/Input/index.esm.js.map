{"version":3,"file":"index.esm.js","sources":["../../src/Input/index.tsx"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { Combobox } from '@sajari/react-components';\nimport { useAutocomplete, useQuery, useSearchContext } from '@sajari/react-hooks';\nimport { __DEV__, isArray } from '@sajari/react-sdk-utils';\nimport React, { useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { useSearchUIContext } from '../ContextProvider';\nimport { useClickTracking } from '../hooks';\nimport { ResultValues } from '../Results/types';\nimport mapResultFields from '../utils/mapResultFields';\nimport { InputProps } from './types';\n\nconst Input = React.forwardRef((props: InputProps<any>, ref: React.Ref<HTMLInputElement>) => {\n  const { t } = useTranslation('input');\n  const { placeholder = t('placeholder'), mode = 'instant', onSelect, onChange, ...rest } = props;\n  const { results: rawResults, search, searching, fields } = useSearchContext();\n  const results = React.useMemo(() => mapResultFields<ResultValues>(rawResults ?? [], fields), [rawResults]);\n  const { search: searchAutocomplete, completion, suggestions } = useAutocomplete();\n  const { customClassNames, disableDefaultStyles = false, tracking } = useSearchUIContext();\n  const { query } = useQuery();\n  let items: Array<any> = [];\n\n  if (mode === 'suggestions') {\n    items = suggestions;\n  } else if (mode === 'results') {\n    // Only display 5 items\n    items = results.splice(0, 5).map((result) => {\n      const { values, token } = result;\n      const { description, image, title } = values;\n      const { href, onClick } = useClickTracking({ tracking, values, token });\n\n      return {\n        title,\n        url: href,\n        onClick,\n        description,\n        image: isArray(image) ? image[0] : image,\n      };\n    });\n  }\n\n  const onChangeMemoized = useCallback(\n    (value) => {\n      if (onChange) {\n        onChange(value);\n      }\n\n      if (mode === 'suggestions' || mode === 'typeahead') {\n        if (searchAutocomplete) {\n          searchAutocomplete(value);\n        }\n      } else if (mode === 'instant' || mode === 'results') {\n        search(value);\n      }\n    },\n    [onChange, mode, search],\n  );\n\n  const onKeyDownMemoized = useCallback(\n    (e) => {\n      if (e.key === 'Enter' && (mode === 'typeahead' || mode === 'suggestions' || mode === 'standard')) {\n        search((e.target as HTMLInputElement).value);\n      }\n    },\n    [mode, search],\n  );\n\n  const onSelectMemoized = useCallback(\n    (item) => {\n      if (onSelect) {\n        onSelect(item);\n      }\n      if (mode === 'suggestions') {\n        search(item as string);\n      }\n    },\n    [mode, search],\n  );\n\n  return (\n    <Combobox\n      {...rest}\n      ref={ref}\n      placeholder={placeholder}\n      mode={mode as Exclude<InputProps<any>['mode'], 'instant'>}\n      items={items}\n      completion={mode === 'typeahead' ? completion : ''}\n      value={query}\n      loading={searching}\n      onChange={onChangeMemoized}\n      onKeyDown={onKeyDownMemoized}\n      onSelect={onSelectMemoized}\n      className={customClassNames.input?.container}\n      dropdownClassName={customClassNames.input?.dropdown}\n      dropdownFooterClassName={customClassNames.input?.dropdownFooter}\n      dropdownHighlightItemClassName={customClassNames.input?.dropdownHighlightItem}\n      dropdownSelectedItemClassName={customClassNames.input?.dropdownSelectedItem}\n      dropdownItemClassName={customClassNames.input?.dropdownItem}\n      dropdownListClassName={customClassNames.input?.dropdownList}\n      inputClassName={customClassNames.input?.input}\n      inputContainerClassName={customClassNames.input?.inputContainer}\n      resultClassName={customClassNames.input?.result}\n      resultImageContainerClassName={customClassNames.input?.resultImageContainer}\n      resultTextContainerClassName={customClassNames.input?.resultTextContainer}\n      selectedResultClassName={customClassNames.input?.selectedResult}\n      typeaheadClassName={customClassNames.input?.typeahead}\n      voiceInputClassName={customClassNames.input?.voiceInput}\n      disableDefaultStyles={disableDefaultStyles}\n    />\n  );\n});\n\nif (__DEV__) {\n  Input.displayName = 'Input';\n}\n\nexport default Input;\nexport type { InputProps };\n"],"names":["Input","React","forwardRef","props","ref","useTranslation","t","placeholder","mode","onSelect","onChange","rest","useSearchContext","rawResults","results","search","searching","fields","useMemo","mapResultFields","useAutocomplete","searchAutocomplete","completion","suggestions","useSearchUIContext","customClassNames","disableDefaultStyles","tracking","useQuery","query","items","splice","map","result","values","token","description","image","title","useClickTracking","href","onClick","url","isArray","onChangeMemoized","useCallback","value","onKeyDownMemoized","e","key","target","onSelectMemoized","item","_jsx","input","container","dropdown","dropdownFooter","dropdownHighlightItem","dropdownSelectedItem","dropdownItem","dropdownList","inputContainer","resultImageContainer","resultTextContainer","selectedResult","typeahead","voiceInput","__DEV__","displayName"],"mappings":"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"}