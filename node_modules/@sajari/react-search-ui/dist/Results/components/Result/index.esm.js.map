{"version":3,"file":"index.esm.js","sources":["../../../../src/Results/components/Result/index.tsx"],"sourcesContent":["/* eslint-disable react/jsx-no-target-blank */\nimport { Box, Heading, Image, ImageProps, Link, Rating, Text } from '@sajari/react-components';\nimport {\n  __DEV__,\n  decodeHTML,\n  formatPrice,\n  getStylesObject,\n  isArray,\n  isNumber,\n  isString,\n  isValidURL,\n} from '@sajari/react-sdk-utils';\nimport React, { useMemo } from 'react';\n\nimport { useSearchUIContext } from '../../../ContextProvider';\nimport { useClickTracking } from '../../../hooks';\nimport useResultStyles from './styles';\nimport { ResultProps } from './types';\n\nconst Result = React.memo(\n  (props: ResultProps) => {\n    const {\n      appearance = 'list',\n      imageAspectRatio: imageAspectRatioProp = 1,\n      imageObjectFit: imageObjectFitProp = 'contain',\n      values,\n      token,\n      forceImage,\n      headingClassName,\n      priceClassName,\n      originalPriceClassName,\n      subTitleClassName,\n      ratingClassName,\n      descriptionClassName,\n      disableDefaultStyles = false,\n      onClick: onClickProp,\n      styles: stylesProp,\n      ...rest\n    } = props;\n    const { currency, language, ratingMax, tracking } = useSearchUIContext();\n    const { href, onClick } = useClickTracking({ token, tracking, values, onClick: onClickProp });\n    const { title, description, subtitle, image, price, originalPrice } = values;\n    const rating = Number(values.rating);\n\n    // Determine if the result is on sale\n    const isOnSale = React.useMemo(() => {\n      if (!price || !originalPrice) {\n        return false;\n      }\n\n      const parsePrices = (input: string | Array<string>) => (isArray(input) ? input : [input]).map(Number);\n      const prices = parsePrices(price);\n      const originalPrices = parsePrices(originalPrice);\n\n      if (originalPrices.length >= prices.length) {\n        return prices.some((p, index) => isNumber(p) && isNumber(originalPrices[index]) && p < originalPrices[index]);\n      }\n\n      if (originalPrices.length === 1 && prices.length > 1) {\n        const [original] = originalPrices;\n\n        if (!isNumber(original)) {\n          return false;\n        }\n\n        return prices.some((p) => isNumber(p) && p < original);\n      }\n\n      return false;\n    }, [JSON.stringify(price), JSON.stringify(originalPrice)]);\n\n    const styles = getStylesObject(useResultStyles({ ...props, appearance, isOnSale }), disableDefaultStyles);\n\n    const imageAspectRatio: ImageProps['aspectRatio'] = useMemo(() => {\n      const aspectRatio = imageAspectRatioProp;\n\n      if (isNumber(aspectRatio) || aspectRatio === null) {\n        return aspectRatio;\n      }\n\n      return aspectRatio[appearance];\n    }, [appearance, imageAspectRatioProp]);\n\n    const imageObjectFit: ImageProps['objectFit'] = useMemo(() => {\n      const objectFit = imageObjectFitProp;\n\n      if (isString(objectFit) || objectFit === null) {\n        return objectFit;\n      }\n\n      return objectFit[appearance];\n    }, [appearance, imageObjectFitProp]);\n\n    const imageSrc = isArray(image) ? image[0] : image;\n    const imageHoverSrc = isArray(image) ? image[1] : undefined;\n\n    const renderTitle = () => (\n      <Heading as=\"h1\" size=\"base\" css={styles.title} className={headingClassName}>\n        <Link href={href} onClick={onClick}>\n          {decodeHTML(title)}\n        </Link>\n      </Heading>\n    );\n\n    const renderSubtitle = () => {\n      if (!subtitle) return null;\n\n      if (isValidURL(subtitle)) {\n        return (\n          <Link\n            href={href}\n            onClick={onClick}\n            css={styles.subtitle}\n            disableDefaultStyles={disableDefaultStyles}\n            className={subTitleClassName}\n          >\n            {subtitle}\n          </Link>\n        );\n      }\n\n      return (\n        <Text css={styles.subtitle} disableDefaultStyles={disableDefaultStyles} className={subTitleClassName}>\n          {subtitle}\n        </Text>\n      );\n    };\n\n    const renderPrice = () => {\n      if (!price) return null;\n\n      return (\n        <Box css={styles.priceContainer}>\n          <Text css={styles.price} className={priceClassName} disableDefaultStyles={disableDefaultStyles}>\n            {formatPrice(price, { currency, language })}\n          </Text>\n\n          {originalPrice && isOnSale && (\n            <Text\n              css={styles.originalPrice}\n              className={originalPriceClassName}\n              disableDefaultStyles={disableDefaultStyles}\n            >\n              {formatPrice(\n                isArray(originalPrice)\n                  ? originalPrice\n                      .map(Number)\n                      .filter((p) => isNumber(p) && p !== 0)\n                      .map(String)\n                  : originalPrice,\n                {\n                  currency,\n                  language,\n                },\n              )}\n            </Text>\n          )}\n        </Box>\n      );\n    };\n\n    return (\n      <Box as=\"article\" {...rest} css={[styles.container, stylesProp]}>\n        {(isValidURL(imageSrc, true) || forceImage) && (\n          <Link\n            href={href}\n            onClick={onClick}\n            onContextMenu={onClick}\n            css={styles.imageContainer}\n            disableDefaultStyles={disableDefaultStyles}\n          >\n            <Image\n              src={imageSrc}\n              hoverSrc={imageHoverSrc}\n              css={styles.image}\n              aspectRatio={imageAspectRatio}\n              objectFit={imageObjectFit}\n              disableDefaultStyles={disableDefaultStyles}\n            />\n          </Link>\n        )}\n\n        <Box css={styles.content}>\n          {appearance === 'list' && (\n            <Box css={styles.header}>\n              <Box>\n                {renderTitle()}\n                {renderSubtitle()}\n              </Box>\n\n              <Box>{renderPrice()}</Box>\n            </Box>\n          )}\n\n          {appearance === 'grid' && (\n            <>\n              {renderTitle()}\n              {renderSubtitle()}\n            </>\n          )}\n\n          {isNumber(rating) && (\n            <Rating\n              value={rating}\n              max={ratingMax}\n              className={ratingClassName}\n              disableDefaultStyles={disableDefaultStyles}\n            />\n          )}\n\n          {appearance === 'list' && description && (\n            <Text truncate={2} css={styles.description} className={descriptionClassName}>\n              {decodeHTML(description)}\n            </Text>\n          )}\n\n          {appearance === 'grid' && renderPrice()}\n        </Box>\n      </Box>\n    );\n  },\n  (prev, next) => JSON.stringify(prev) === JSON.stringify(next),\n);\n\nif (__DEV__) {\n  Result.displayName = 'Result';\n}\n\nexport default Result;\nexport type { ResultProps };\n"],"names":["Result","React","memo","props","appearance","imageAspectRatio","imageAspectRatioProp","imageObjectFit","imageObjectFitProp","values","token","forceImage","headingClassName","priceClassName","originalPriceClassName","subTitleClassName","ratingClassName","descriptionClassName","disableDefaultStyles","onClickProp","onClick","stylesProp","styles","rest","useSearchUIContext","currency","language","ratingMax","tracking","useClickTracking","href","title","description","subtitle","image","price","originalPrice","rating","Number","isOnSale","useMemo","parsePrices","input","isArray","map","prices","originalPrices","length","some","p","index","isNumber","original","JSON","stringify","getStylesObject","useResultStyles","aspectRatio","objectFit","isString","imageSrc","imageHoverSrc","undefined","renderTitle","_jsx","decodeHTML","renderSubtitle","isValidURL","renderPrice","_jsxs","priceContainer","formatPrice","filter","String","container","imageContainer","content","header","prev","next","__DEV__","displayName"],"mappings":";;;;;;;;;;AAmBA,IAAMA,MAAM,gBAAGC,cAAK,CAACC,IAAN,CACb,UAACC,KAAD;0BAkBMA,MAhBFC;MAAAA,4CAAa;8BAgBXD,MAfFE;MAAkBC,0DAAuB;8BAevCH,MAdFI;MAAgBC,wDAAqB;MACrCC,SAaEN,MAbFM;MACAC,QAYEP,MAZFO;MACAC,aAWER,MAXFQ;MACAC,mBAUET,MAVFS;MACAC,iBASEV,MATFU;MACAC,yBAQEX,MARFW;MACAC,oBAOEZ,MAPFY;MACAC,kBAMEb,MANFa;MACAC,uBAKEd,MALFc;8BAKEd,MAJFe;MAAAA,0DAAuB;MACdC,cAGPhB,MAHFiB;MACQC,aAENlB,MAFFmB;MACGC,qCACDpB;;4BACgDqB,kBAAkB;MAA9DC,+BAAAA;MAAUC,+BAAAA;MAAUC,gCAAAA;MAAWC,+BAAAA;;0BACbC,gBAAgB,CAAC;AAAEnB,IAAAA,KAAK,EAALA,KAAF;AAASkB,IAAAA,QAAQ,EAARA,QAAT;AAAmBnB,IAAAA,MAAM,EAANA,MAAnB;AAA2BW,IAAAA,OAAO,EAAED;AAApC,GAAD;MAAlCW,yBAAAA;MAAMV,4BAAAA;;MACNW,QAA8DtB,OAA9DsB;MAAOC,cAAuDvB,OAAvDuB;MAAaC,WAA0CxB,OAA1CwB;MAAUC,QAAgCzB,OAAhCyB;MAAOC,QAAyB1B,OAAzB0B;MAAOC,gBAAkB3B,OAAlB2B;AACpD,MAAMC,MAAM,GAAGC,MAAM,CAAC7B,MAAM,CAAC4B,MAAR,CAArB;AAGA,MAAME,QAAQ,GAAGtC,cAAK,CAACuC,OAAN,CAAc;AAC7B,QAAI,CAACL,KAAD,IAAU,CAACC,aAAf,EAA8B;AAC5B,aAAO,KAAP;AACD;;AAED,QAAMK,WAAW,GAAG,SAAdA,WAAc,CAACC,KAAD;AAAA,aAAmC,CAACC,OAAO,CAACD,KAAD,CAAP,GAAiBA,KAAjB,GAAyB,CAACA,KAAD,CAA1B,EAAmCE,GAAnC,CAAuCN,MAAvC,CAAnC;AAAA,KAApB;;AACA,QAAMO,MAAM,GAAGJ,WAAW,CAACN,KAAD,CAA1B;AACA,QAAMW,cAAc,GAAGL,WAAW,CAACL,aAAD,CAAlC;;AAEA,QAAIU,cAAc,CAACC,MAAf,IAAyBF,MAAM,CAACE,MAApC,EAA4C;AAC1C,aAAOF,MAAM,CAACG,IAAP,CAAY,UAACC,CAAD,EAAIC,KAAJ;AAAA,eAAcC,QAAQ,CAACF,CAAD,CAAR,IAAeE,QAAQ,CAACL,cAAc,CAACI,KAAD,CAAf,CAAvB,IAAkDD,CAAC,GAAGH,cAAc,CAACI,KAAD,CAAlF;AAAA,OAAZ,CAAP;AACD;;AAED,QAAIJ,cAAc,CAACC,MAAf,KAA0B,CAA1B,IAA+BF,MAAM,CAACE,MAAP,GAAgB,CAAnD,EAAsD;AAAA,UAC7CK,QAD6C,GACjCN,cADiC;;AAGpD,UAAI,CAACK,QAAQ,CAACC,QAAD,CAAb,EAAyB;AACvB,eAAO,KAAP;AACD;;AAED,aAAOP,MAAM,CAACG,IAAP,CAAY,UAACC,CAAD;AAAA,eAAOE,QAAQ,CAACF,CAAD,CAAR,IAAeA,CAAC,GAAGG,QAA1B;AAAA,OAAZ,CAAP;AACD;;AAED,WAAO,KAAP;AACD,GAxBgB,EAwBd,CAACC,IAAI,CAACC,SAAL,CAAenB,KAAf,CAAD,EAAwBkB,IAAI,CAACC,SAAL,CAAelB,aAAf,CAAxB,CAxBc,CAAjB;AA0BA,MAAMd,MAAM,GAAGiC,eAAe,CAACC,eAAe,cAAMrD,KAAN;AAAaC,IAAAA,UAAU,EAAVA,UAAb;AAAyBmC,IAAAA,QAAQ,EAARA;AAAzB,KAAhB,EAAsDrB,oBAAtD,CAA9B;AAEA,MAAMb,gBAAgB,GAA8BmC,OAAO,CAAC;AAC1D,QAAMiB,WAAW,GAAGnD,oBAApB;;AAEA,QAAI6C,QAAQ,CAACM,WAAD,CAAR,IAAyBA,WAAW,KAAK,IAA7C,EAAmD;AACjD,aAAOA,WAAP;AACD;;AAED,WAAOA,WAAW,CAACrD,UAAD,CAAlB;AACD,GAR0D,EAQxD,CAACA,UAAD,EAAaE,oBAAb,CARwD,CAA3D;AAUA,MAAMC,cAAc,GAA4BiC,OAAO,CAAC;AACtD,QAAMkB,SAAS,GAAGlD,kBAAlB;;AAEA,QAAImD,QAAQ,CAACD,SAAD,CAAR,IAAuBA,SAAS,KAAK,IAAzC,EAA+C;AAC7C,aAAOA,SAAP;AACD;;AAED,WAAOA,SAAS,CAACtD,UAAD,CAAhB;AACD,GARsD,EAQpD,CAACA,UAAD,EAAaI,kBAAb,CARoD,CAAvD;AAUA,MAAMoD,QAAQ,GAAGjB,OAAO,CAACT,KAAD,CAAP,GAAiBA,KAAK,CAAC,CAAD,CAAtB,GAA4BA,KAA7C;AACA,MAAM2B,aAAa,GAAGlB,OAAO,CAACT,KAAD,CAAP,GAAiBA,KAAK,CAAC,CAAD,CAAtB,GAA4B4B,SAAlD;;AAEA,MAAMC,WAAW,GAAG,SAAdA,WAAc;AAAA,WAClBC,IAAC,OAAD;AAAS,MAAA,EAAE,EAAC,IAAZ;AAAiB,MAAA,IAAI,EAAC,MAAtB;AAA6B,MAAA,GAAG,EAAE1C,MAAM,CAACS,KAAzC;AAAgD,MAAA,SAAS,EAAEnB,gBAA3D;AAAA,gBACEoD,IAAC,IAAD;AAAM,QAAA,IAAI,EAAElC,IAAZ;AAAkB,QAAA,OAAO,EAAEV,OAA3B;AAAA,kBACG6C,UAAU,CAAClC,KAAD;AADb;AADF,MADkB;AAAA,GAApB;;AAQA,MAAMmC,cAAc,GAAG,SAAjBA,cAAiB;AACrB,QAAI,CAACjC,QAAL,EAAe,OAAO,IAAP;;AAEf,QAAIkC,UAAU,CAAClC,QAAD,CAAd,EAA0B;AACxB,aACE+B,IAAC,IAAD;AACE,QAAA,IAAI,EAAElC,IADR;AAEE,QAAA,OAAO,EAAEV,OAFX;AAGE,QAAA,GAAG,EAAEE,MAAM,CAACW,QAHd;AAIE,QAAA,oBAAoB,EAAEf,oBAJxB;AAKE,QAAA,SAAS,EAAEH,iBALb;AAAA,kBAOGkB;AAPH,QADF;AAWD;;AAED,WACE+B,IAAC,IAAD;AAAM,MAAA,GAAG,EAAE1C,MAAM,CAACW,QAAlB;AAA4B,MAAA,oBAAoB,EAAEf,oBAAlD;AAAwE,MAAA,SAAS,EAAEH,iBAAnF;AAAA,gBACGkB;AADH,MADF;AAKD,GAtBD;;AAwBA,MAAMmC,WAAW,GAAG,SAAdA,WAAc;AAClB,QAAI,CAACjC,KAAL,EAAY,OAAO,IAAP;AAEZ,WACEkC,KAAC,GAAD;AAAK,MAAA,GAAG,EAAE/C,MAAM,CAACgD,cAAjB;AAAA,iBACEN,IAAC,IAAD;AAAM,QAAA,GAAG,EAAE1C,MAAM,CAACa,KAAlB;AAAyB,QAAA,SAAS,EAAEtB,cAApC;AAAoD,QAAA,oBAAoB,EAAEK,oBAA1E;AAAA,kBACGqD,WAAW,CAACpC,KAAD,EAAQ;AAAEV,UAAAA,QAAQ,EAARA,QAAF;AAAYC,UAAAA,QAAQ,EAARA;AAAZ,SAAR;AADd,QADF,EAKGU,aAAa,IAAIG,QAAjB,IACCyB,IAAC,IAAD;AACE,QAAA,GAAG,EAAE1C,MAAM,CAACc,aADd;AAEE,QAAA,SAAS,EAAEtB,sBAFb;AAGE,QAAA,oBAAoB,EAAEI,oBAHxB;AAAA,kBAKGqD,WAAW,CACV5B,OAAO,CAACP,aAAD,CAAP,GACIA,aAAa,CACVQ,GADH,CACON,MADP,EAEGkC,MAFH,CAEU,UAACvB,CAAD;AAAA,iBAAOE,QAAQ,CAACF,CAAD,CAAR,IAAeA,CAAC,KAAK,CAA5B;AAAA,SAFV,EAGGL,GAHH,CAGO6B,MAHP,CADJ,GAKIrC,aANM,EAOV;AACEX,UAAAA,QAAQ,EAARA,QADF;AAEEC,UAAAA,QAAQ,EAARA;AAFF,SAPU;AALd,QANJ;AAAA,MADF;AA4BD,GA/BD;;AAiCA,SACE2C,KAAC,GAAD;AAAK,IAAA,EAAE,EAAC;AAAR,KAAsB9C,IAAtB;AAA4B,IAAA,GAAG,oBAAE,CAACD,MAAM,CAACoD,SAAR,EAAmBrD,UAAnB,CAAF,kkQAA/B;AAAA,eACG,CAAC8C,UAAU,CAACP,QAAD,EAAW,IAAX,CAAV,IAA8BjD,UAA/B,KACCqD,IAAC,IAAD;AACE,MAAA,IAAI,EAAElC,IADR;AAEE,MAAA,OAAO,EAAEV,OAFX;AAGE,MAAA,aAAa,EAAEA,OAHjB;AAIE,MAAA,GAAG,EAAEE,MAAM,CAACqD,cAJd;AAKE,MAAA,oBAAoB,EAAEzD,oBALxB;AAAA,gBAOE8C,IAAC,KAAD;AACE,QAAA,GAAG,EAAEJ,QADP;AAEE,QAAA,QAAQ,EAAEC,aAFZ;AAGE,QAAA,GAAG,EAAEvC,MAAM,CAACY,KAHd;AAIE,QAAA,WAAW,EAAE7B,gBAJf;AAKE,QAAA,SAAS,EAAEE,cALb;AAME,QAAA,oBAAoB,EAAEW;AANxB;AAPF,MAFJ,EAoBEmD,KAAC,GAAD;AAAK,MAAA,GAAG,EAAE/C,MAAM,CAACsD,OAAjB;AAAA,iBACGxE,UAAU,KAAK,MAAf,IACCiE,KAAC,GAAD;AAAK,QAAA,GAAG,EAAE/C,MAAM,CAACuD,MAAjB;AAAA,mBACER,KAAC,GAAD;AAAA,qBACGN,WAAW,EADd,EAEGG,cAAc,EAFjB;AAAA,UADF,EAMEF,IAAC,GAAD;AAAA,oBAAMI,WAAW;AAAjB,UANF;AAAA,QAFJ,EAYGhE,UAAU,KAAK,MAAf,IACCiE;AAAA,mBACGN,WAAW,EADd,EAEGG,cAAc,EAFjB;AAAA,QAbJ,EAmBGf,QAAQ,CAACd,MAAD,CAAR,IACC2B,IAAC,MAAD;AACE,QAAA,KAAK,EAAE3B,MADT;AAEE,QAAA,GAAG,EAAEV,SAFP;AAGE,QAAA,SAAS,EAAEX,eAHb;AAIE,QAAA,oBAAoB,EAAEE;AAJxB,QApBJ,EA4BGd,UAAU,KAAK,MAAf,IAAyB4B,WAAzB,IACCgC,IAAC,IAAD;AAAM,QAAA,QAAQ,EAAE,CAAhB;AAAmB,QAAA,GAAG,EAAE1C,MAAM,CAACU,WAA/B;AAA4C,QAAA,SAAS,EAAEf,oBAAvD;AAAA,kBACGgD,UAAU,CAACjC,WAAD;AADb,QA7BJ,EAkCG5B,UAAU,KAAK,MAAf,IAAyBgE,WAAW,EAlCvC;AAAA,MApBF;AAAA,KADF;AA2DD,CAzMY,EA0Mb,UAACU,IAAD,EAAOC,IAAP;AAAA,SAAgB1B,IAAI,CAACC,SAAL,CAAewB,IAAf,MAAyBzB,IAAI,CAACC,SAAL,CAAeyB,IAAf,CAAzC;AAAA,CA1Ma,CAAf;;AA6MA,IAAIC,OAAJ,EAAa;AACXhF,EAAAA,MAAM,CAACiF,WAAP,GAAqB,QAArB;AACD;;;;"}