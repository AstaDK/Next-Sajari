import { useFilter } from '@sajari/react-hooks';
import { useTheme, isEmpty } from '@sajari/react-sdk-utils';
import 'react';
import { useTranslation } from 'react-i18next';
import { jsx, jsxs } from '@emotion/core/jsx-runtime';
import { useSearchUIContext } from '../ContextProvider/index.esm.js';
import { Tabs, TabList, Tab, Box } from '@sajari/react-components';
import { formatLabel } from './utils.esm.js';
import _css from '@emotion/css';

var TabFilter = function TabFilter(props) {
  var _customClassNames$fil, _customClassNames$fil2, _customClassNames$fil3, _customClassNames$fil4, _customClassNames$fil5, _customClassNames$fil6, _customClassNames$fil7, _customClassNames$fil8;

  var name = props.name,
      title = props.title,
      _props$limit = props.limit,
      limit = _props$limit === void 0 ? 15 : _props$limit,
      _props$sort = props.sort,
      sort = _props$sort === void 0 ? 'count' : _props$sort,
      _props$sortAscending = props.sortAscending,
      sortAscending = _props$sortAscending === void 0 ? sort !== 'count' : _props$sortAscending,
      format = props.format;

  var _useTranslation = useTranslation('filter'),
      t = _useTranslation.t;

  var theme = useTheme();

  var _useFilter = useFilter(name, {
    sort: sort,
    sortAscending: sortAscending
  }),
      options = _useFilter.options,
      setSelected = _useFilter.setSelected,
      selected = _useFilter.selected;

  var sliced = limit && options.length > limit ? options.slice(0, limit) : options;

  var _useSearchUIContext = useSearchUIContext(),
      _useSearchUIContext$d = _useSearchUIContext.disableDefaultStyles,
      disableDefaultStyles = _useSearchUIContext$d === void 0 ? false : _useSearchUIContext$d,
      customClassNames = _useSearchUIContext.customClassNames,
      currency = _useSearchUIContext.currency,
      language = _useSearchUIContext.language;

  if (isEmpty(sliced)) {
    return null;
  }

  var selectedIndex = sliced.findIndex(function (_ref) {
    var label = _ref.label;
    return label === selected[0];
  });
  return jsx(Tabs, {
    "aria-label": title,
    onChange: function onChange(index) {
      return setSelected(index !== 0 ? [sliced[index - 1].label] : []);
    },
    index: selectedIndex < 0 ? 0 : selectedIndex + 1,
    disableDefaultStyles: disableDefaultStyles,
    className: (_customClassNames$fil = customClassNames.filter) == null ? void 0 : (_customClassNames$fil2 = _customClassNames$fil.tabs) == null ? void 0 : _customClassNames$fil2.container,
    children: jsxs(TabList, {
      className: (_customClassNames$fil3 = customClassNames.filter) == null ? void 0 : (_customClassNames$fil4 = _customClassNames$fil3.tabs) == null ? void 0 : _customClassNames$fil4.list,
      children: [jsx(Tab, {
        className: (_customClassNames$fil5 = customClassNames.filter) == null ? void 0 : (_customClassNames$fil6 = _customClassNames$fil5.tabs) == null ? void 0 : _customClassNames$fil6.tab,
        selectedClassName: (_customClassNames$fil7 = customClassNames.filter) == null ? void 0 : (_customClassNames$fil8 = _customClassNames$fil7.tabs) == null ? void 0 : _customClassNames$fil8.selectedTab,
        children: t('all')
      }), sliced.map(function (_ref2, index) {
        var _customClassNames$fil9, _customClassNames$fil10, _customClassNames$fil11, _customClassNames$fil12;

        var label = _ref2.label,
            count = _ref2.count,
            value = _ref2.value;
        return jsxs(Tab, {
          className: (_customClassNames$fil9 = customClassNames.filter) == null ? void 0 : (_customClassNames$fil10 = _customClassNames$fil9.tabs) == null ? void 0 : _customClassNames$fil10.tab,
          selectedClassName: (_customClassNames$fil11 = customClassNames.filter) == null ? void 0 : (_customClassNames$fil12 = _customClassNames$fil11.tabs) == null ? void 0 : _customClassNames$fil12.selectedTab,
          children: ["" + formatLabel(label, {
            format: format,
            currency: currency,
            t: t
          }), jsx(Box, {
            as: "span",
            css: /*#__PURE__*/_css([{
              "paddingTop": "0.125rem",
              "paddingBottom": "0.125rem",
              "paddingLeft": "0.25rem",
              "paddingRight": "0.25rem",
              "borderRadius": "0.25rem",
              "marginLeft": "0.75rem",
              "fontSize": "0.75rem",
              "lineHeight": "1.25",
              "transitionProperty": "background-color, border-color, color, fill, stroke"
            }, index === selectedIndex ? {
              backgroundColor: theme.color.primary.active,
              color: theme.color.primary.text
            } : {
              "--text-opacity": "1",
              "color": "rgba(107, 114, 128, var(--text-opacity))",
              "--bg-opacity": "1",
              "backgroundColor": "rgba(244, 245, 247, var(--bg-opacity))"
            }], ";label:TabFilter;" + (process.env.NODE_ENV === "production" ? "" : "/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRhYkZpbHRlci50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBMEIyQiIsImZpbGUiOiJUYWJGaWx0ZXIudHN4Iiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQm94LCBUYWIsIFRhYkxpc3QsIFRhYnMgfSBmcm9tICdAc2FqYXJpL3JlYWN0LWNvbXBvbmVudHMnO1xyXG5pbXBvcnQgeyB1c2VGaWx0ZXIgfSBmcm9tICdAc2FqYXJpL3JlYWN0LWhvb2tzJztcclxuaW1wb3J0IHsgaXNFbXB0eSwgdXNlVGhlbWUgfSBmcm9tICdAc2FqYXJpL3JlYWN0LXNkay11dGlscyc7XHJcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgdXNlVHJhbnNsYXRpb24gfSBmcm9tICdyZWFjdC1pMThuZXh0JztcclxuaW1wb3J0IHR3IGZyb20gJ3R3aW4ubWFjcm8nO1xyXG5pbXBvcnQgeyB1c2VTZWFyY2hVSUNvbnRleHQgfSBmcm9tICcuLi9Db250ZXh0UHJvdmlkZXInO1xyXG5pbXBvcnQgeyBmb3JtYXRMYWJlbCB9IGZyb20gJy4vdXRpbHMnO1xyXG5jb25zdCBUYWJGaWx0ZXIgPSAocHJvcHMpID0+IHtcclxuICAgIGNvbnN0IHsgbmFtZSwgdGl0bGUsIGxpbWl0ID0gMTUsIHNvcnQgPSAnY291bnQnLCBzb3J0QXNjZW5kaW5nID0gc29ydCAhPT0gJ2NvdW50JywgZm9ybWF0IH0gPSBwcm9wcztcclxuICAgIGNvbnN0IHsgdCB9ID0gdXNlVHJhbnNsYXRpb24oJ2ZpbHRlcicpO1xyXG4gICAgY29uc3QgdGhlbWUgPSB1c2VUaGVtZSgpO1xyXG4gICAgY29uc3QgeyBvcHRpb25zLCBzZXRTZWxlY3RlZCwgc2VsZWN0ZWQgfSA9IHVzZUZpbHRlcihuYW1lLCB7IHNvcnQsIHNvcnRBc2NlbmRpbmcgfSk7XHJcbiAgICBjb25zdCBzbGljZWQgPSBsaW1pdCAmJiBvcHRpb25zLmxlbmd0aCA+IGxpbWl0ID8gb3B0aW9ucy5zbGljZSgwLCBsaW1pdCkgOiBvcHRpb25zO1xyXG4gICAgY29uc3QgeyBkaXNhYmxlRGVmYXVsdFN0eWxlcyA9IGZhbHNlLCBjdXN0b21DbGFzc05hbWVzLCBjdXJyZW5jeSwgbGFuZ3VhZ2UgfSA9IHVzZVNlYXJjaFVJQ29udGV4dCgpO1xyXG4gICAgaWYgKGlzRW1wdHkoc2xpY2VkKSkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgc2VsZWN0ZWRJbmRleCA9IHNsaWNlZC5maW5kSW5kZXgoKHsgbGFiZWwgfSkgPT4gbGFiZWwgPT09IHNlbGVjdGVkWzBdKTtcclxuICAgIHJldHVybiAoPFRhYnMgYXJpYS1sYWJlbD17dGl0bGV9IG9uQ2hhbmdlPXsoaW5kZXgpID0+IHNldFNlbGVjdGVkKGluZGV4ICE9PSAwID8gW3NsaWNlZFtpbmRleCAtIDFdLmxhYmVsXSA6IFtdKX0gaW5kZXg9e3NlbGVjdGVkSW5kZXggPCAwID8gMCA6IHNlbGVjdGVkSW5kZXggKyAxfSBkaXNhYmxlRGVmYXVsdFN0eWxlcz17ZGlzYWJsZURlZmF1bHRTdHlsZXN9IGNsYXNzTmFtZT17Y3VzdG9tQ2xhc3NOYW1lcy5maWx0ZXI/LnRhYnM/LmNvbnRhaW5lcn0+XG4gICAgICA8VGFiTGlzdCBjbGFzc05hbWU9e2N1c3RvbUNsYXNzTmFtZXMuZmlsdGVyPy50YWJzPy5saXN0fT5cbiAgICAgICAgPFRhYiBjbGFzc05hbWU9e2N1c3RvbUNsYXNzTmFtZXMuZmlsdGVyPy50YWJzPy50YWJ9IHNlbGVjdGVkQ2xhc3NOYW1lPXtjdXN0b21DbGFzc05hbWVzLmZpbHRlcj8udGFicz8uc2VsZWN0ZWRUYWJ9PlxuICAgICAgICAgIHt0KCdhbGwnKX1cbiAgICAgICAgPC9UYWI+XG4gICAgICAgIHtzbGljZWQubWFwKCh7IGxhYmVsLCBjb3VudCwgdmFsdWUgfSwgaW5kZXgpID0+ICg8VGFiIGtleT17dmFsdWV9IGNsYXNzTmFtZT17Y3VzdG9tQ2xhc3NOYW1lcy5maWx0ZXI/LnRhYnM/LnRhYn0gc2VsZWN0ZWRDbGFzc05hbWU9e2N1c3RvbUNsYXNzTmFtZXMuZmlsdGVyPy50YWJzPy5zZWxlY3RlZFRhYn0+XG4gICAgICAgICAgICB7YCR7Zm9ybWF0TGFiZWwobGFiZWwsIHsgZm9ybWF0LCBjdXJyZW5jeSwgdCB9KX1gfVxuICAgICAgICAgICAgPEJveCBhcz1cInNwYW5cIiBjc3M9e1tcclxuICAgICAgICB0dyBgcHktMC41IHB4LTEgcm91bmRlZCBtbC0zIHRleHQteHMgbGVhZGluZy10aWdodCB0cmFuc2l0aW9uLWNvbG9yc2AsXHJcbiAgICAgICAgaW5kZXggPT09IHNlbGVjdGVkSW5kZXhcclxuICAgICAgICAgICAgPyB7IGJhY2tncm91bmRDb2xvcjogdGhlbWUuY29sb3IucHJpbWFyeS5hY3RpdmUsIGNvbG9yOiB0aGVtZS5jb2xvci5wcmltYXJ5LnRleHQgfVxyXG4gICAgICAgICAgICA6IHR3IGB0ZXh0LWdyYXktNTAwIGJnLWdyYXktMTAwYCxcclxuICAgIF19PlxuICAgICAgICAgICAgICB7Y291bnQudG9Mb2NhbGVTdHJpbmcobGFuZ3VhZ2UpfVxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgPC9UYWI+KSl9XG4gICAgICA8L1RhYkxpc3Q+XG4gICAgPC9UYWJzPik7XHJcbn07XHJcbmV4cG9ydCBkZWZhdWx0IFRhYkZpbHRlcjtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VGFiRmlsdGVyLmpzeC5tYXAiXX0= */")),
            children: count.toLocaleString(language)
          })]
        }, value);
      })]
    })
  });
};

export default TabFilter;
//# sourceMappingURL=TabFilter.esm.js.map
