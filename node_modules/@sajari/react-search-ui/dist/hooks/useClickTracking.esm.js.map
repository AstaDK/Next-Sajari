{"version":3,"file":"useClickTracking.esm.js","sources":["../../src/hooks/useClickTracking.ts"],"sourcesContent":["import { ClickTracking, PosNegTracking, Token } from '@sajari/react-hooks';\nimport { isEmpty, isFunction, isString, isValidURL, noop } from '@sajari/react-sdk-utils';\n\nimport { ResultValues } from '../Results/types';\n\ninterface UseClickTrackingParams {\n  token: Token | undefined;\n  tracking: ClickTracking | PosNegTracking | undefined;\n  values: ResultValues;\n  onClick?: (url: string) => void;\n}\n\nfunction useClickTracking(params: UseClickTrackingParams) {\n  const { onClick, token, tracking, values } = params;\n  const { url } = values;\n\n  if (!tracking) {\n    return {\n      href: url,\n      onClick: noop,\n    };\n  }\n\n  // Get the click token from the response\n  const clickToken = token && 'click' in token ? token.click : undefined;\n  // Determine if the field used for the token is a valid URL (then it can redirect)\n  const useToken =\n    !isEmpty(clickToken) && Object.keys(values).includes(tracking.field) && isValidURL(values[tracking.field]);\n  // Determine href to use for links\n  const href = useToken ? clickToken : url;\n\n  const onClickHandler = () => {\n    if (isFunction(onClick)) {\n      onClick(url);\n    }\n\n    // Fire the click token using sendBeacon if we didn't use it for the href\n    if (!useToken && isString(clickToken) && isFunction(navigator?.sendBeacon)) {\n      navigator.sendBeacon(clickToken);\n    }\n  };\n\n  return {\n    href,\n    onClick: onClickHandler,\n  };\n}\n\nexport default useClickTracking;\n"],"names":["useClickTracking","params","onClick","token","tracking","values","url","href","noop","clickToken","click","undefined","useToken","isEmpty","Object","keys","includes","field","isValidURL","onClickHandler","isFunction","isString","navigator","sendBeacon"],"mappings":";;AAYA,SAASA,gBAAT,CAA0BC,MAA1B;MACUC,UAAqCD,OAArCC;MAASC,QAA4BF,OAA5BE;MAAOC,WAAqBH,OAArBG;MAAUC,SAAWJ,OAAXI;MAC1BC,MAAQD,OAARC;;AAER,MAAI,CAACF,QAAL,EAAe;AACb,WAAO;AACLG,MAAAA,IAAI,EAAED,GADD;AAELJ,MAAAA,OAAO,EAAEM;AAFJ,KAAP;AAID;;AAGD,MAAMC,UAAU,GAAGN,KAAK,IAAI,WAAWA,KAApB,GAA4BA,KAAK,CAACO,KAAlC,GAA0CC,SAA7D;AAEA,MAAMC,QAAQ,GACZ,CAACC,OAAO,CAACJ,UAAD,CAAR,IAAwBK,MAAM,CAACC,IAAP,CAAYV,MAAZ,EAAoBW,QAApB,CAA6BZ,QAAQ,CAACa,KAAtC,CAAxB,IAAwEC,UAAU,CAACb,MAAM,CAACD,QAAQ,CAACa,KAAV,CAAP,CADpF;AAGA,MAAMV,IAAI,GAAGK,QAAQ,GAAGH,UAAH,GAAgBH,GAArC;;AAEA,MAAMa,cAAc,GAAG,SAAjBA,cAAiB;;;AACrB,QAAIC,UAAU,CAAClB,OAAD,CAAd,EAAyB;AACvBA,MAAAA,OAAO,CAACI,GAAD,CAAP;AACD;;AAGD,QAAI,CAACM,QAAD,IAAaS,QAAQ,CAACZ,UAAD,CAArB,IAAqCW,UAAU,eAACE,SAAD,qBAAC,WAAWC,UAAZ,CAAnD,EAA4E;AAC1ED,MAAAA,SAAS,CAACC,UAAV,CAAqBd,UAArB;AACD;AACF,GATD;;AAWA,SAAO;AACLF,IAAAA,IAAI,EAAJA,IADK;AAELL,IAAAA,OAAO,EAAEiB;AAFJ,GAAP;AAID;;;;"}